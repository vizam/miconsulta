extends layout
block head
  link(rel='stylesheet' href='/stylesheets/mystyles.css')
  script(src='/javascripts/gui.js')
block content
  //Navigation bar
  div.w3-bar.w3-theme.w3-large.noprint(style='position: sticky; top: 0')
    a.w3-bar-item.w3-button.w3-hover-white(href="/")
      span.fas.fa-home
    span.w3-bar-item.w3-wide Historia Clínica
    a.w3-bar-item.w3-button.w3-right.w3-hover-white(href="/users/logout")
      span.fas.fa-sign-out-alt
    a.w3-bar-item.w3-button.w3-right.w3-hover-white(href="/ajustes")
      span.fas.fa-user-cog
    a.w3-bar-item.w3-button.w3-right.w3-hover-white(
    href="javascript: void(0)" onclick='print()')
      span.fas.fa-print
    a.w3-bar-item.w3-button.w3-right.w3-hover-white(
    href="/records")
      span.fas.fa-search
    a.w3-bar-item.w3-button.w3-right.w3-hover-white(
    href="javascript: void(0)" title='Create Note'
    onclick='document.getElementById("modalInput").style.display = "block"')
      span.fas.fa-pen
  // Some code
  - 
    let hoy = new Date();
    const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio',
      'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
    let nacimiento = new Date(fdn);
    let años = hoy.getFullYear() - nacimiento.getFullYear();
    let ajuste = hoy.getMonth() >= nacimiento.getMonth() && hoy.getDate() >= nacimiento.getDate() ? 0 : -1;
  // Content
  div.w3-auto.w3-padding
    // Printer only
    h1.w3-right-align.print Informe Médico
    h6.w3-right-align.print Fecha de elaboración: #{`${hoy.getDate()}-${meses[hoy.getMonth()]}-${hoy.getFullYear()}`}
    // Content
    ul.w3-ul.w3-section.w3-card-4.w3-large
      li
        span.fas.fa-fingerprint
        span.w3-margin #{id}
      li
        span.far.fa-user
        span.w3-margin #{nombre}&nbsp;#{apellido}
      li
        span.far.fa-clock
        span.w3-margin #{años + ajuste}
          span &nbsp;años
      li
        span.fas.fa-mobile-alt
        a.w3-margin(href=`tel:${tel}`) &nbsp;#{tel} 
    div#divNotas
      - if (notas.length == 0)
        h1.w3-center
          span.w3-margin.fas.fa-info-circle.w3-text-blue
          span No hay notas almacenadas
      - for (let x = 0; x < notas.length; x++)
        - let fecha = new Date(notas[x].stamp);
        div(style='display: none')
          h4.w3-theme.noprint
            span.far.fa-calendar.w3-margin-left.w3-animate-right
            span.w3-margin-left.w3-animate-opacity #{`${fecha.getDate()}-${meses[fecha.getMonth()]}-${fecha.getFullYear()}`}
          //Print only
          span.print Fecha de evaluación: #{ `${fecha.getDate()}-${meses[fecha.getMonth()]}-${fecha.getFullYear()}` }   
          // Content
          h4 Enfermedad Actual
          p(style="text-indent: 10pt") #{ notas[x].enfactual }
          h4 Antecedentes
          p #{antecedentes}
          h4 Examen Físico
          p #{ notas[x].exfisico }
          h4 Exámenes Complementarios
          p #{ notas[x].excomple }
          h4 Diagnósticos
          p #{ notas[x].diagnosticos }
          h4 Tratamiento
          p #{ notas[x].tratamiento }
    
    
  // Pagination of notes
  div#paginador.w3-bar.w3-center.noprint(onclick='cambiarPagina(event)' style="position: fixed; bottom: 20px;")
    span.fas.fa-angle-double-left.w3-margin-right(title=`Shift + Left`)
    - for (let x = 0; x < notas.length ; x++)
      a.w3-button.w3-hover-white(href='javascript: void(0)') #{x+1}
    span.fas.fa-angle-double-right.w3-margin-left(title=`Shift + Right`)

  include panelinfo.pug
  include newnote.pug
  include pieinforme.pug

  script.
    document.querySelector('body').classList.add('w3-theme-l4');
    window.onload = function () {
      paginarNotas();
      panelInformativo();
    }
    window.onbeforeprint = poblarInforme;
    document.onkeydown = paginadorTeclas;



